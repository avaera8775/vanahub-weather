import{d as Z,r as y,c as h,o as j,i as J,a as d,b as e,n as C,t as o,h as i,_ as K,w as Q,v as X,F as _,f as w,e as S,g as E,j as M}from"./index-CDyPvys3.js";import{a as k}from"./api-BXmuLqoz.js";const $=1009810800,L=2300;class z{static getCurrentVanaTime(){return Math.floor(Date.now()/1e3)-$}static getEarthTimeForVanaDay(r){const s=this.getCurrentVanaTime(),x=((Math.floor(s/L)+r)*L+$)*1e3;return new Date(x)}static getTimeUntilWeatherChange(r){const s=this.getEarthTimeForVanaDay(r),n=new Date,u=s.getTime()-n.getTime();if(u<=0)return r===0?{hours:0,minutes:0,seconds:0,totalSeconds:0,isActive:!0}:{hours:0,minutes:0,seconds:0,totalSeconds:0,isActive:!1};const g=Math.floor(u/1e3),x=Math.floor(g/3600),v=Math.floor(g%3600/60),c=g%60;return{hours:x,minutes:v,seconds:c,totalSeconds:g,isActive:!1}}static formatTimeRemaining(r){if(r.isActive)return"Active now";if(r.totalSeconds<=0)return"Past";const s=[];return r.hours>0&&s.push(`${r.hours}h`),r.minutes>0&&s.push(`${r.minutes}m`),r.hours===0&&s.push(`${r.seconds}s`),s.join(" ")}static formatDetailedTimeRemaining(r){if(r.isActive)return"Active now";if(r.totalSeconds<=0)return"Past";const s=r.hours,n=Math.floor(s/24),u=s%24;return n>0?`${n}d ${u}h ${r.minutes}m`:u>0?`${u}h ${r.minutes}m ${r.seconds}s`:`${r.minutes}m ${r.seconds}s`}}const R={class:"flex items-center space-x-2"},ee=Z({__name:"WeatherCountdown",props:{daysForward:{}},setup(F){const r=F,s=y({hours:0,minutes:0,seconds:0,totalSeconds:0,isActive:!1});let n=null;const u=()=>{s.value=z.getTimeUntilWeatherChange(r.daysForward)},g=h(()=>z.formatDetailedTimeRemaining(s.value));return j(()=>{u(),n=window.setInterval(u,1e3)}),J(()=>{n!==null&&(clearInterval(n),n=null)}),(x,v)=>(i(),d("div",R,[v[0]||(v[0]=e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",{class:C(["text-sm font-medium",s.value.isActive?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-300"])},o(g.value),3)]))}}),P=K(ee,[["__scopeId","data-v-70c0eb37"]]),te={class:"max-w-6xl mx-auto px-4 py-8"},ae={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 mb-6 border border-gray-200 dark:border-gray-700"},re={class:"mb-4"},se=["value"],oe={class:"mb-4 p-3 bg-blue-50 rounded-lg dark:bg-blue-900/20"},ne={class:"text-lg font-semibold text-blue-900 dark:text-blue-100"},le={key:0},de={key:1,class:"text-gray-500"},ie={class:"mb-4"},ue={class:"flex flex-wrap gap-2"},ce=["onClick"],ge={key:0,class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-8 text-center border border-gray-200 dark:border-gray-700"},ve={key:1,class:"error-card"},ye={class:"error-text"},xe={key:2,class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-8 text-center border border-gray-200 dark:border-gray-700"},me={class:"text-gray-500 dark:text-gray-400"},he={key:0},fe={key:1},be={key:2},ke={key:3,class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700"},pe={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},_e={class:"text-lg font-semibold text-gray-600 dark:text-gray-300"},we={key:0,class:"text-sm font-normal text-gray-500 dark:text-gray-400"},Ce={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},Fe={class:"p-6 space-y-4"},We={class:"flex items-center justify-between mb-3"},Ae={class:"flex items-center space-x-4"},Se={class:"text-sm font-medium text-gray-600 dark:text-gray-300"},Te={key:0,class:"font-semibold text-blue-600 dark:text-blue-400"},De={key:0,class:"text-xs"},Ne={key:1,class:"flex items-center space-x-3 text-xs text-gray-500 dark:text-gray-400"},Ve={class:"flex items-center space-x-6"},Ee={class:"text-left"},Me={class:"text-sm font-medium text-gray-700 dark:text-gray-200"},$e={class:"text-left"},Le={class:"text-sm font-medium text-gray-700 dark:text-gray-200"},ze={class:"text-left"},Pe={class:"text-sm font-medium text-gray-700 dark:text-gray-200"},Ze={key:0,class:"flex items-center justify-between px-6 py-4"},je={class:"text-sm text-gray-500 dark:text-gray-400"},Be={class:"flex space-x-2"},Oe=["disabled"],Ie=["onClick"],He=["disabled"],T=10,qe=Z({__name:"WeatherView",setup(F){const r=y([]),s=y("ALL_ZONES"),n=y(null),u=y([]),g=y(null),x=y(!1),v=y(""),c=y(1),B=["Sunshine","Clouds","Fog","Hot Spell","Heat Wave","Rain","Squall","Dust Storm","Sand Storm","Wind","Gales","Snow","Blizzard","Thunder","Thunderstorms","Auroras","Stellar Glare","Gloom","Darkness"],f=h(()=>n.value?u.value.filter(l=>l.commonWeather===n.value||l.normalWeather===n.value||l.rareWeather===n.value):u.value),p=h(()=>Math.ceil(f.value.length/T)),W=h(()=>(c.value-1)*T),D=h(()=>Math.min(W.value+T,f.value.length)),N=h(()=>f.value.slice(W.value,D.value)),O=h(()=>{const l=Math.max(1,c.value-2),a=Math.min(p.value,c.value+2),t=[];for(let m=l;m<=a;m++)t.push(m);return t}),b=l=>k.formatZoneName(l),I=()=>s.value==="ALL_ZONES"?"All Zones":b(s.value),H=async()=>{try{r.value=await k.getWeatherZones()}catch(l){console.error("Error loading zones:",l),v.value="Failed to load zones"}},U=async()=>{try{g.value=await k.getCurrentVanaDate()}catch(l){console.error("Error loading current date:",l)}},A=async()=>{if(s.value){x.value=!0,v.value="";try{if(s.value==="ALL_ZONES"){const l=[];for(const a of r.value)try{const t=await k.getWeatherForecast(a,30);l.push(...t.days)}catch(t){console.warn(`Failed to load weather for zone ${a}:`,t)}l.sort((a,t)=>a.daysForward!==t.daysForward?a.daysForward-t.daysForward:a.zone.localeCompare(t.zone)),u.value=l}else{const l=await k.getWeatherForecast(s.value,30);u.value=l.days}c.value=1}catch(l){console.error("Error loading weather data:",l),v.value="Failed to load weather data",u.value=[]}finally{x.value=!1}}},V=l=>{n.value=l,c.value=1},G=l=>{c.value=l},q=()=>{c.value>1&&c.value--},Y=()=>{c.value<p.value&&c.value++};return j(async()=>{await H(),await U(),await A()}),(l,a)=>(i(),d("div",te,[a[13]||(a[13]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-2"},"Weather Forecast"),e("p",{class:"text-gray-600 dark:text-gray-300"}," Track Vana'diel weather patterns and plan your adventures ")],-1)),e("div",ae,[e("div",re,[a[3]||(a[3]=e("label",{class:"block text-sm font-medium text-gray-600 dark:text-gray-300 mb-2"}," Zone ",-1)),Q(e("select",{"onUpdate:modelValue":a[0]||(a[0]=t=>s.value=t),onChange:A,class:"w-full max-w-xs px-3 py-2 text-sm text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600"},[a[2]||(a[2]=e("option",{value:"ALL_ZONES"},"All Zones",-1)),(i(!0),d(_,null,w(r.value,t=>(i(),d("option",{key:t,value:t},o(b(t)),9,se))),128))],544),[[X,s.value]])]),e("div",oe,[a[4]||(a[4]=e("div",{class:"text-sm font-medium text-blue-800 dark:text-blue-200"}," Current Vana'diel Time ",-1)),e("div",ne,[g.value?(i(),d("span",le,o(g.value.dateString)+" ("+o(g.value.elementalDayName)+") ",1)):(i(),d("span",de,"Loading..."))])]),e("div",ie,[a[5]||(a[5]=e("label",{class:"block text-sm font-medium text-gray-600 dark:text-gray-300 mb-2"}," Filter by Weather Type ",-1)),e("div",ue,[e("button",{onClick:a[1]||(a[1]=t=>V(null)),class:C(["px-3 py-1 text-xs font-medium rounded-lg transition-colors duration-150",n.value?"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600":"bg-blue-500 text-white"])}," All Weather ",2),(i(),d(_,null,w(B,t=>e("button",{key:t,onClick:m=>V(t),class:C(["px-3 py-1 text-xs font-medium rounded-lg transition-colors duration-150",n.value===t?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"])},o(t),11,ce)),64))])])]),x.value?(i(),d("div",ge,a[6]||(a[6]=[e("div",{class:"flex justify-center items-center space-x-3"},[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}),e("span",{class:"text-gray-600 dark:text-gray-300"},"Loading weather data...")],-1)]))):v.value?(i(),d("div",ve,[a[7]||(a[7]=e("div",{class:"flex items-center space-x-2 mb-2"},[e("svg",{class:"w-5 h-5 error-text",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"error-text font-medium"},"Error loading weather data")],-1)),e("p",ye,o(v.value),1),e("button",{onClick:A,class:"mt-3 btn-primary"}," Try Again ")])):N.value.length===0?(i(),d("div",xe,[e("div",me,[a[8]||(a[8]=e("svg",{class:"w-12 h-12 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})],-1)),e("p",null,[n.value&&s.value==="ALL_ZONES"?(i(),d("span",he,' No weather data found for "'+o(n.value)+'" in any zone ',1)):n.value?(i(),d("span",fe,' No weather data found for "'+o(n.value)+'" in '+o(b(s.value)),1)):(i(),d("span",be," No weather data available for "+o(b(s.value)),1))])])])):(i(),d("div",ke,[e("div",pe,[e("h4",_e,[E(" Weather Forecast - "+o(I())+" ",1),n.value?(i(),d("span",we," (Filtered by "+o(n.value)+") ",1)):S("",!0)]),e("p",Ce,o(f.value.length)+" forecast"+o(f.value.length!==1?"s":"")+" found ",1)]),e("div",Fe,[(i(!0),d(_,null,w(N.value,(t,m)=>(i(),d("div",{key:m,class:"p-4 bg-gray-50 rounded-lg dark:border-l-4 dark:border-gray-700 dark:bg-gray-700"},[e("div",We,[e("div",Ae,[e("div",Se,[s.value==="ALL_ZONES"?(i(),d("span",Te,o(b(t.zone))+" - ",1)):S("",!0),E(" "+o(t.date.dateString)+" ("+o(t.date.elementalDayName)+") ",1)]),t.daysForward===0?(i(),d("div",De,[M(P,{daysForward:t.daysForward},null,8,["daysForward"])])):(i(),d("div",Ne,[e("span",null,"in "+o(t.daysForward)+" day"+o(t.daysForward!==1?"s":""),1),a[9]||(a[9]=e("span",{class:"text-gray-400"},"|",-1)),M(P,{daysForward:t.daysForward},null,8,["daysForward"])]))])]),e("div",Ve,[e("div",Ee,[a[10]||(a[10]=e("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"Common",-1)),e("div",Me,o(t.commonWeather),1)]),e("div",$e,[a[11]||(a[11]=e("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"Normal",-1)),e("div",Le,o(t.normalWeather),1)]),e("div",ze,[a[12]||(a[12]=e("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"Rare",-1)),e("div",Pe,o(t.rareWeather),1)])])]))),128))]),p.value>1?(i(),d("div",Ze,[e("div",je," Showing "+o(W.value+1)+" to "+o(D.value)+" of "+o(f.value.length)+" results ",1),e("div",Be,[e("button",{onClick:q,disabled:c.value===1,class:"pagination-btn"}," Previous ",8,Oe),(i(!0),d(_,null,w(O.value,t=>(i(),d("button",{key:t,onClick:m=>G(t),class:C(["pagination-btn",{"bg-blue-500 text-white border-blue-500":t===c.value}])},o(t),11,Ie))),128)),e("button",{onClick:Y,disabled:c.value===p.value,class:"pagination-btn"}," Next ",8,He)])])):S("",!0)]))]))}});export{qe as default};
